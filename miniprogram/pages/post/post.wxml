<!-- å¸–å­è¯¦æƒ…é¡µé¢ -->
<view class="container">
  <!-- å¸–å­å†…å®¹ -->
  <view class="post-content">
    <!-- ä½œè€…ä¿¡æ¯ -->
    <view class="author-section">
      <image class="avatar" src="{{post.author.avatar}}" />
      <view class="author-info">
        <text class="author-name">{{post.author.name}}</text>
        <text class="post-time">{{post.time}}</text>
      </view>
      <view class="author-actions">
        <button class="follow-btn" bindtap="followAuthor" wx:if="{{!post.author.isFollowed}}">å…³æ³¨</button>
        <button class="followed-btn" bindtap="unfollowAuthor" wx:else>å·²å…³æ³¨</button>
      </view>
    </view>

    <!-- å¸–å­æ ‡é¢˜ -->
    <view class="post-title">
      <text>{{post.title}}</text>
    </view>

    <!-- å¸–å­æè¿° -->
    <view class="post-desc">
      <text>{{post.desc}}</text>
    </view>

    <!-- å¸–å­å›¾ç‰‡ -->
    <view class="post-images" wx:if="{{post.images && post.images.length > 0}}">
      <image 
        wx:for="{{post.images}}" 
        wx:key="index" 
        src="{{item}}" 
        class="post-image"
        bindtap="previewImage"
        data-url="{{item}}"
        data-urls="{{post.images}}"
      />
    </view>

    <!-- å¸–å­æ ‡ç­¾ -->
    <view class="post-tags" wx:if="{{post.tags && post.tags.length > 0}}">
      <text 
        wx:for="{{post.tags}}" 
        wx:key="index" 
        class="tag-item"
      >{{item}}</text>
    </view>

    <!-- ä»·æ ¼ä¿¡æ¯ -->
    <view class="price-section" wx:if="{{post.price}}">
      <text class="price-label">ä»·æ ¼ï¼š</text>
      <text class="price-value">{{post.price}}</text>
    </view>

    <!-- ä½ç½®ä¿¡æ¯ -->
    <view class="location-section" wx:if="{{post.location}}">
      <icon type="location" size="16" color="#999" />
      <text class="location-text">{{post.location}}</text>
    </view>

    <!-- äº’åŠ¨ç»Ÿè®¡ -->
    <view class="stats-section">
      <view class="stat-item">
        <icon type="eye" size="16" color="#999" />
        <text class="stat-number">{{post.stats.views}}</text>
        <text class="stat-label">æµè§ˆ</text>
      </view>
      <view class="stat-item">
        <icon type="like" size="16" color="{{post.isLiked ? '#ff4757' : '#999'}}" />
        <text class="stat-number">{{post.stats.likes}}</text>
        <text class="stat-label">ç‚¹èµ</text>
      </view>
      <view class="stat-item">
        <icon type="comment" size="16" color="#999" />
        <text class="stat-number">{{post.stats.comments}}</text>
        <text class="stat-label">è¯„è®º</text>
      </view>
      <view class="stat-item">
        <icon type="share" size="16" color="#999" />
        <text class="stat-number">0</text>
        <text class="stat-label">åˆ†äº«</text>
      </view>
    </view>
  </view>

  <!-- äº’åŠ¨æŒ‰é’® -->
  <view class="action-bar">
    <view class="action-item {{post.isLiked ? 'liked' : ''}}" bindtap="toggleLike">
      <view class="action-icon">
        <icon type="like" size="24" color="{{post.isLiked ? '#ff4757' : '#666'}}" />
      </view>
      <text class="action-text">{{post.isLiked ? 'å·²ç‚¹èµ' : 'ç‚¹èµ'}}</text>
    </view>
    <view class="action-item" bindtap="showCommentInput">
      <view class="action-icon">
        <icon type="comment" size="24" color="#666" />
      </view>
      <text class="action-text">å†™è¯„è®º</text>
    </view>
    <view class="action-item" bindtap="sharePost">
      <view class="action-icon">
        <icon type="share" size="24" color="#666" />
      </view>
      <text class="action-text">åˆ†äº«</text>
    </view>
    <view class="action-item" bindtap="reportPost">
      <view class="action-icon warning">
        <icon type="warn" size="24" color="#666" />
      </view>
      <text class="action-text">ä¸¾æŠ¥</text>
    </view>
  </view>

  <!-- è¯„è®ºåŒºåŸŸ -->
  <view class="comments-section">
    <view class="section-title">
      <text>è¯„è®º ({{comments.length}})</text>
    </view>
    <view class="comment-list">
      <view 
        wx:for="{{comments}}" 
        wx:key="id" 
        class="comment-item"
      >
        <image class="comment-avatar" src="{{item.author.avatar}}" />
        <view class="comment-content">
          <view class="comment-header">
            <text class="comment-author">{{item.author.name}}</text>
            <text class="comment-time">{{item.time}}</text>
          </view>
          <text class="comment-text">{{item.content}}</text>
          <view class="comment-actions">
            <text class="reply-btn" bindtap="replyComment" data-comment="{{item}}">å›å¤</text>
            <text class="like-btn {{item.isLiked ? 'liked' : ''}}" bindtap="likeComment" data-id="{{item.id}}">
              {{item.isLiked ? 'å·²èµ' : 'èµ'}} ({{item.likes}})
            </text>
          </view>
        </view>
      </view>
    </view>
    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-comments" wx:if="{{comments.length === 0}}">
      <text class="empty-icon">ğŸ’¬</text>
      <text class="empty-text">æš‚æ— è¯„è®ºï¼Œå¿«æ¥å‘è¡¨ç¬¬ä¸€æ¡è¯„è®ºå§ï¼</text>
    </view>
  </view>

  <!-- ç›¸å…³æ¨è -->
  <view class="related-section" wx:if="{{relatedPosts.length > 0}}">
    <view class="section-title">
      <text>ç›¸å…³æ¨è</text>
    </view>
    <view class="related-list">
      <view 
        wx:for="{{relatedPosts}}" 
        wx:key="id" 
        class="related-item"
        bindtap="goToPost"
        data-post="{{item}}"
      >
        <image class="related-image" src="{{item.cover}}" />
        <view class="related-info">
          <text class="related-title">{{item.title}}</text>
          <text class="related-price">{{item.price}}</text>
        </view>
      </view>
    </view>
  </view>
</view>

<!-- è¯„è®ºè¾“å…¥æ¡† -->
<view class="comment-input-modal" wx:if="{{showCommentInput}}">
  <view class="modal-mask" bindtap="hideCommentInput"></view>
  <view class="comment-input-container">
    <textarea 
      class="comment-textarea" 
      placeholder="å†™ä¸‹ä½ çš„è¯„è®º..." 
      value="{{commentText}}"
      bindinput="onCommentInput"
      auto-focus="{{true}}"
    ></textarea>
    <view class="comment-input-actions">
      <button class="cancel-btn" bindtap="hideCommentInput">å–æ¶ˆ</button>
      <button class="submit-btn" bindtap="submitComment">å‘é€</button>
    </view>
  </view>
</view> 