<!-- åº—é“ºé¡µé¢ -->
<view class="container">
  <!-- åº—é“ºå¤´éƒ¨ä¿¡æ¯ -->
  <view class="shop-header">
    <view class="shop-banner">
      <image class="banner-image" src="{{shop.banner}}" mode="aspectFill" />
      <view class="shop-overlay">
        <view class="shop-info">
          <image class="shop-avatar" src="{{shop.avatar}}" />
          <view class="shop-details">
            <text class="shop-name">{{shop.name}}</text>
            <text class="shop-desc">{{shop.description}}</text>
            <view class="shop-stats">
              <text class="stat-item">å•†å“ {{shop.productCount}}</text>
              <text class="stat-item">ç²‰ä¸ {{shop.followerCount}}</text>
              <text class="stat-item">è¯„åˆ† {{shop.rating}}</text>
            </view>
          </view>
        </view>
        <view class="shop-actions">
          <button class="follow-btn" bindtap="toggleFollow" wx:if="{{!shop.isFollowed}}">
            <icon type="add" size="16" color="#fff" />
            <text>å…³æ³¨</text>
          </button>
          <button class="followed-btn" bindtap="toggleFollow" wx:else>
            <icon type="success" size="16" color="#666" />
            <text>å·²å…³æ³¨</text>
          </button>
          <button class="contact-btn" bindtap="contactShop">
            <icon type="chat" size="16" color="#fff" />
            <text>è”ç³»</text>
          </button>
        </view>
      </view>
    </view>
  </view>

  <!-- åº—é“ºå¯¼èˆª -->
  <view class="shop-nav">
    <view 
      class="nav-item {{currentTab === 'products' ? 'active' : ''}}" 
      bindtap="switchTab" 
      data-tab="products"
    >
      <text>å•†å“</text>
    </view>
    <view 
      class="nav-item {{currentTab === 'reviews' ? 'active' : ''}}" 
      bindtap="switchTab" 
      data-tab="reviews"
    >
      <text>è¯„ä»·</text>
    </view>
    <view 
      class="nav-item {{currentTab === 'info' ? 'active' : ''}}" 
      bindtap="switchTab" 
      data-tab="info"
    >
      <text>åº—é“ºä¿¡æ¯</text>
    </view>
  </view>

  <!-- å•†å“åˆ—è¡¨ -->
  <view class="tab-content" wx:if="{{currentTab === 'products'}}">
    <view class="filter-bar">
      <view class="filter-item" bindtap="showSortOptions">
        <text>{{sortText}}</text>
        <icon type="arrow" size="12" color="#999" />
      </view>
      <view class="filter-item" bindtap="showCategoryOptions">
        <text>{{categoryText}}</text>
        <icon type="arrow" size="12" color="#999" />
      </view>
    </view>

    <view class="product-grid">
      <view 
        wx:for="{{products}}" 
        wx:key="id" 
        class="product-item"
        bindtap="goToProduct"
        data-product="{{item}}"
      >
        <image class="product-image" src="{{item.image}}" mode="aspectFill" />
        <view class="product-info">
          <text class="product-title">{{item.title}}</text>
          <text class="product-price">{{item.price}}</text>
          <view class="product-stats">
            <text class="sales-count">å·²å”® {{item.salesCount}}</text>
            <text class="rating">â­ {{item.rating}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{products.length === 0}}">
      <text class="empty-icon">ğŸ“¦</text>
      <text class="empty-title">æš‚æ— å•†å“</text>
      <text class="empty-desc">è¯¥åº—é“ºè¿˜æ²¡æœ‰ä¸Šæ¶å•†å“</text>
    </view>
  </view>

  <!-- è¯„ä»·åˆ—è¡¨ -->
  <view class="tab-content" wx:if="{{currentTab === 'reviews'}}">
    <view class="review-stats">
      <view class="rating-overview">
        <text class="overall-rating">{{shop.rating}}</text>
        <text class="rating-label">ç»¼åˆè¯„åˆ†</text>
      </view>
      <view class="rating-breakdown">
        <view class="rating-item">
          <text class="rating-label">å•†å“è´¨é‡</text>
          <text class="rating-value">{{shop.qualityRating}}</text>
        </view>
        <view class="rating-item">
          <text class="rating-label">æœåŠ¡æ€åº¦</text>
          <text class="rating-value">{{shop.serviceRating}}</text>
        </view>
        <view class="rating-item">
          <text class="rating-label">ç‰©æµé€Ÿåº¦</text>
          <text class="rating-value">{{shop.logisticsRating}}</text>
        </view>
      </view>
    </view>

    <view class="review-list">
      <view 
        wx:for="{{reviews}}" 
        wx:key="id" 
        class="review-item"
      >
        <view class="review-header">
          <image class="reviewer-avatar" src="{{item.user.avatar}}" />
          <view class="reviewer-info">
            <text class="reviewer-name">{{item.user.name}}</text>
            <view class="review-rating">
              <text wx:for="{{item.rating}}" wx:key="index" class="star">â­</text>
            </view>
          </view>
          <text class="review-time">{{item.time}}</text>
        </view>
        <text class="review-content">{{item.content}}</text>
        <view class="review-images" wx:if="{{item.images && item.images.length > 0}}">
          <image 
            wx:for="{{item.images}}" 
            wx:key="index" 
            src="{{item}}" 
            class="review-image"
            bindtap="previewImage"
            data-url="{{item}}"
            data-urls="{{item.images}}"
          />
        </view>
        <view class="review-product">
          <text class="product-name">{{item.productName}}</text>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{reviews.length === 0}}">
      <text class="empty-icon">ğŸ’¬</text>
      <text class="empty-title">æš‚æ— è¯„ä»·</text>
      <text class="empty-desc">è¯¥åº—é“ºè¿˜æ²¡æœ‰æ”¶åˆ°è¯„ä»·</text>
    </view>
  </view>

  <!-- åº—é“ºä¿¡æ¯ -->
  <view class="tab-content" wx:if="{{currentTab === 'info'}}">
    <view class="info-section">
      <view class="info-item">
        <text class="info-label">åº—é“ºåç§°</text>
        <text class="info-value">{{shop.name}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">åº—é“ºåœ°å€</text>
        <text class="info-value">{{shop.address}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">è”ç³»ç”µè¯</text>
        <text class="info-value" bindtap="callShop">{{shop.phone}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">è¥ä¸šæ—¶é—´</text>
        <text class="info-value">{{shop.businessHours}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">åº—é“ºç®€ä»‹</text>
        <text class="info-value">{{shop.description}}</text>
      </view>
    </view>

    <view class="certification-section">
      <view class="section-title">åº—é“ºè®¤è¯</view>
      <view class="certification-list">
        <view class="certification-item" wx:for="{{shop.certifications}}" wx:key="type">
          <icon type="success" size="16" color="#00c851" />
          <text>{{item.name}}</text>
        </view>
      </view>
    </view>
  </view>
</view>

<!-- æ’åºé€‰é¡¹å¼¹çª— -->
<view class="sort-modal" wx:if="{{showSortModal}}">
  <view class="modal-mask" bindtap="hideSortModal"></view>
  <view class="sort-options">
    <view class="option-item" wx:for="{{sortOptions}}" wx:key="value" bindtap="selectSort" data-sort="{{item}}">
      <text>{{item.label}}</text>
      <icon type="success" size="16" color="#00c851" wx:if="{{currentSort === item.value}}" />
    </view>
  </view>
</view>

<!-- åˆ†ç±»é€‰é¡¹å¼¹çª— -->
<view class="category-modal" wx:if="{{showCategoryModal}}">
  <view class="modal-mask" bindtap="hideCategoryModal"></view>
  <view class="category-options">
    <view class="option-item" wx:for="{{categoryOptions}}" wx:key="value" bindtap="selectCategory" data-category="{{item}}">
      <text>{{item.label}}</text>
      <icon type="success" size="16" color="#00c851" wx:if="{{currentCategory === item.value}}" />
    </view>
  </view>
</view>